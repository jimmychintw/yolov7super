# æ··æ·†çŸ©é™£èˆ‡åˆ†é¡ç­–ç•¥åˆ†æå ±å‘Š

## 1. å•é¡ŒèƒŒæ™¯

åœ¨è¨­è¨ˆ 1B4H (1 Backbone 4 Heads) æ¶æ§‹æ™‚ï¼Œå¦‚ä½•å°‡ 80 å€‹ COCO é¡åˆ¥åˆ†é…åˆ° 4 å€‹ Headï¼Ÿ

### 1.1 ä¸‰å€‹å¹³è¡¡å› ç´ 

| å› ç´  | å½±éŸ¿ | é‡è¦æ€§ |
|------|------|--------|
| **é¡åˆ¥ç¨ç«‹æ€§ï¼ˆåæ··æ·†ï¼‰** | æ··æ·†é¡åˆ¥æ”¾åŒä¸€ Head æœƒåœ¨ softmax ä¸­ç«¶çˆ­ | â­â­â­ æœ€é‡è¦ |
| **æ¨£æœ¬æ•¸å¹³è¡¡** | æ¨£æœ¬å°‘çš„é¡åˆ¥å­¸ä¸å¥½ï¼Œæ¢¯åº¦è¢«ç¨€é‡‹ | â­â­ é‡è¦ |
| **é¡åˆ¥æ•¸å¹³è¡¡** | åªå½±éŸ¿ Head è¼¸å‡ºå±¤å¤§å° | â­ ä¸å¤ªé‡è¦ |

### 1.2 é—œéµçµè«–

```
é‡è¦æ€§æ’åºï¼šé¡åˆ¥ç¨ç«‹æ€§ >> æ¨£æœ¬æ•¸å¹³è¡¡ > é¡åˆ¥æ•¸å¹³è¡¡
```

---

## 2. COCO è³‡æ–™é›†çµ±è¨ˆ

### 2.1 æ¨£æœ¬æ•¸åˆ†ä½ˆï¼ˆæ¥µåº¦ä¸å¹³è¡¡ï¼‰

| é¡åˆ¥ | bbox æ•¸é‡ | ä½”æ¯” |
|------|-----------|------|
| person | 262,465 | **30.52%** |
| car | 43,867 | 5.10% |
| chair | 38,491 | 4.48% |
| ... | ... | ... |
| toaster | 225 | 0.03% |
| hair drier | 198 | 0.02% |

**æ¥µç«¯å·®è·ï¼šperson æ˜¯ hair drier çš„ 1,325 å€ï¼**

### 2.2 æ¨£æœ¬æ•¸åˆ†ä½ˆåœ–

```
person      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 30.5%
car         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 5.1%
chair       â–ˆâ–ˆâ–ˆâ–ˆ 4.5%
book        â–ˆâ–ˆâ–ˆ 2.9%
bottle      â–ˆâ–ˆâ–ˆ 2.8%
cup         â–ˆâ–ˆ 2.4%
...
toaster     â– 0.03%
hair drier  â– 0.02%
```

---

## 3. æ··æ·†çŸ©é™£åˆ†æ

### 3.1 1B1H 500ep æ··æ·†çŸ©é™£

![æ··æ·†çŸ©é™£](analysis_1b1h_confusion_matrix.png)

### 3.2 é«˜æ··æ·†é¡åˆ¥å°ï¼ˆå¿…é ˆåˆ†åˆ°ä¸åŒ Headï¼‰

| æ··æ·†å° | æ··æ·†ç¨‹åº¦ | åŸå›  |
|--------|----------|------|
| car â†” truck | ğŸ”´ é«˜ | å½¢ç‹€ç›¸ä¼¼ï¼Œéƒ½æ˜¯è»Šè¼› |
| bicycle â†” motorcycle | ğŸ”´ é«˜ | å…©è¼ªäº¤é€šå·¥å…· |
| cat â†” dog | ğŸ”´ é«˜ | å››è¶³å¯µç‰© |
| sheep â†” cow | ğŸ”´ é«˜ | è¾²å ´å‹•ç‰© |
| fork â†” knife â†” spoon | ğŸ”´ é«˜ | é¤å…·ä¸‰ä»¶å¥— |
| wine glass â†” cup | ğŸ”´ é«˜ | éƒ½æ˜¯å®¹å™¨ |
| apple â†” orange | ğŸ”´ é«˜ | åœ“å½¢æ°´æœ |
| chair â†” couch | ğŸ”´ é«˜ | åº§æ¤…é¡ |
| mouse â†” remote | ğŸ”´ é«˜ | å°å‹æ‰‹æŒç‰©å“ |
| cell phone â†” remote | ğŸ”´ é«˜ | é•·æ–¹å½¢æ‰‹æŒç‰©å“ |
| microwave â†” oven | ğŸ”´ é«˜ | å»šæˆ¿é›»å™¨ |
| skis â†” snowboard | ğŸ”´ é«˜ | é›ªä¸Šé‹å‹•å™¨æ |
| backpack â†” handbag | ğŸ”´ é«˜ | èƒŒåŒ…/æ‰‹æåŒ… |
| bus â†” truck | ğŸŸ¡ ä¸­ | å¤§å‹è»Šè¼› |
| car â†” bus | ğŸŸ¡ ä¸­ | è»Šè¼› |
| couch â†” bed | ğŸŸ¡ ä¸­ | å¤§å‹å®¶å…· |
| horse â†” cow | ğŸŸ¡ ä¸­ | å¤§å‹å‹•ç‰© |

---

## 4. åæ··æ·†åˆ†é¡ç­–ç•¥

### 4.1 è¨­è¨ˆåŸå‰‡

1. **é«˜æ··æ·†é¡åˆ¥å¿…é ˆåˆ†é–‹**ï¼šä¸èƒ½æ”¾åœ¨åŒä¸€å€‹ Head
2. **æ¨£æœ¬æ•¸ç›¡é‡å¹³è¡¡**ï¼šå„ Head çš„ bbox ç¸½æ•¸æ¥è¿‘
3. **é¡åˆ¥æ•¸æ¬¡è¦è€ƒæ…®**ï¼šä¸éœ€è¦å®Œå…¨å¹³å‡

### 4.2 æ¼”ç®—æ³•

```python
# è²ªå©ªåœ–è‘—è‰²æ¼”ç®—æ³•
1. å»ºç«‹è¡çªåœ–ï¼šæ··æ·†å°ä¹‹é–“é€£é‚Š
2. æŒ‰æ¨£æœ¬æ•¸æ’åºï¼ˆå¾å¤šåˆ°å°‘ï¼‰
3. å°æ¯å€‹é¡åˆ¥ï¼š
   a. æ‰¾å‡ºæ‰€æœ‰ç„¡è¡çªçš„ Head
   b. é¸æ“‡æ¨£æœ¬æ•¸æœ€å°‘çš„ Head æ”¾å…¥
   c. å¦‚æœæ‰€æœ‰ Head éƒ½æœ‰è¡çªï¼Œæ”¾å…¥æ¨£æœ¬æœ€å°‘çš„ï¼ˆçŠ§ç‰²åæ··æ·†ï¼‰
```

### 4.3 åˆ†é¡çµæœ

| Head | é¡åˆ¥æ•¸ | æ¨£æœ¬æ•¸ | ä½”æ¯” | ä¸»è¦é¡åˆ¥ |
|------|--------|--------|------|----------|
| **Head 0** | 1 | 262,465 | 30.5% | person (ç¨ä½”) |
| **Head 1** | 26 | 199,806 | 23.2% | car, motorcycle, airplane, bird, horse... |
| **Head 2** | 26 | 198,854 | 23.1% | bus, cat, sheep, chair, cup, knife... |
| **Head 3** | 27 | 198,876 | 23.1% | bicycle, truck, dog, cow, fork, apple... |

### 4.4 è©³ç´°åˆ†é…

#### Head 0: Person å°ˆç”¨ (1 é¡)
```
person
```
> person ä½” 30.5% æ¨£æœ¬ï¼Œç¨ç«‹ä¸€å€‹ Head å°ˆé–€è™•ç†

#### Head 1: 26 é¡
```
car, motorcycle, airplane, parking meter, bench, bird, horse,
elephant, bear, handbag, skis, wine glass, spoon, sandwich,
orange, hot dog, pizza, couch, potted plant, dining table,
laptop, oven, refrigerator, clock, teddy bear, toothbrush
```

#### Head 2: 26 é¡
```
bus, boat, traffic light, stop sign, cat, sheep, zebra, giraffe,
snowboard, sports ball, kite, baseball glove, skateboard, surfboard,
cup, knife, carrot, donut, chair, bed, mouse, cell phone,
microwave, sink, vase, hair drier
```

#### Head 3: 27 é¡
```
bicycle, train, truck, fire hydrant, dog, cow, backpack, umbrella,
tie, suitcase, frisbee, baseball bat, tennis racket, bottle, fork,
bowl, banana, apple, broccoli, cake, toilet, tv, remote,
keyboard, toaster, book, scissors
```

### 4.5 åæ··æ·†é©—è­‰

âœ… **æ‰€æœ‰ 19 å°é«˜æ··æ·†é¡åˆ¥éƒ½å·²åˆ†é–‹ï¼**

| æ··æ·†å° | Head åˆ†é… | ç‹€æ…‹ |
|--------|-----------|------|
| car â†” truck | Head 1 â†” Head 3 | âœ… |
| bicycle â†” motorcycle | Head 3 â†” Head 1 | âœ… |
| cat â†” dog | Head 2 â†” Head 3 | âœ… |
| sheep â†” cow | Head 2 â†” Head 3 | âœ… |
| fork â†” knife | Head 3 â†” Head 2 | âœ… |
| knife â†” spoon | Head 2 â†” Head 1 | âœ… |
| fork â†” spoon | Head 3 â†” Head 1 | âœ… |
| chair â†” couch | Head 2 â†” Head 1 | âœ… |
| ... | ... | âœ… |

---

## 5. æ¨£æœ¬å¹³è¡¡åº¦åˆ†æ

### 5.1 å„ Head æ¨£æœ¬æ•¸

```
Head 0: 262,465 (30.5%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Head 1: 199,806 (23.2%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Head 2: 198,854 (23.1%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Head 3: 198,876 (23.1%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

### 5.2 å¹³è¡¡åº¦æŒ‡æ¨™

- **æœ€å¤§æ¨£æœ¬æ•¸**: 262,465 (Head 0)
- **æœ€å°æ¨£æœ¬æ•¸**: 198,854 (Head 2)
- **æœ€å¤§/æœ€å°æ¯”ä¾‹**: 1.32x âœ… å¯æ¥å—

### 5.3 person å•é¡Œ

person é¡åˆ¥ä½” 30.5%ï¼Œå°è‡´ï¼š
- è‹¥èˆ‡å…¶ä»–é¡åˆ¥åˆä½µï¼Œè©² Head æ¨£æœ¬æ•¸æœƒéé«˜
- ç¨ç«‹ä¸€å€‹ Head å¯è®“å…¶ä»– 3 å€‹ Head æ›´å¹³è¡¡ (23.1-23.2%)

---

## 6. èˆ‡ç¾æœ‰åˆ†é¡ç­–ç•¥æ¯”è¼ƒ

| ç­–ç•¥ | é¡åˆ¥æ•¸ | æ¨£æœ¬æ•¸å¹³è¡¡ | åæ··æ·† | è¨­è¨ˆä¾æ“š |
|------|--------|------------|--------|----------|
| **Standard** | 20/20/20/20 | âŒ ä¸å¹³è¡¡ | âŒ æœªè€ƒæ…® | äººç‚ºèªæ„åˆ†é¡ |
| **Geometry** | ä¾é•·å¯¬æ¯” | âŒ ä¸å¹³è¡¡ | âŒ éƒ¨åˆ†è€ƒæ…® | bbox å¹¾ä½•ç‰¹å¾µ |
| **Hybrid Balanced** | 15/25/25/15 | ğŸŸ¡ éƒ¨åˆ†å¹³è¡¡ | ğŸŸ¡ éƒ¨åˆ†è€ƒæ…® | å¹¾ä½•+å…±ç¾é »ç‡ |
| **AntiConfusion** | 1/26/26/27 | âœ… 1.32x | âœ… 100% åˆ†é–‹ | æ··æ·†çŸ©é™£+æ¨£æœ¬æ•¸ |

---

## 7. YAML è¨­å®šæª”

```yaml
# coco_320_1b4h_anticonfusion.yaml
nc: 80
heads: 4
grouping: anticonfusion

head_assignments:
  head_0:
    name: "Person_Specialist"
    classes: [0]
    nc: 1
    sample_count: 262465
    weight: 1.0
    comment: "person ç¨ä½”ï¼Œè™•ç† 30.5% æ¨£æœ¬"

  head_1:
    name: "AntiConfusion_Group_1"
    classes: [2, 3, 4, 12, 13, 14, 17, 20, 21, 26, 30, 40, 44, 48, 49, 52, 53, 57, 58, 60, 63, 69, 72, 74, 77, 79]
    nc: 26
    sample_count: 199806
    weight: 1.0

  head_2:
    name: "AntiConfusion_Group_2"
    classes: [5, 8, 9, 11, 15, 18, 22, 23, 31, 32, 33, 35, 36, 37, 41, 43, 51, 54, 56, 59, 64, 67, 68, 71, 75, 78]
    nc: 26
    sample_count: 198854
    weight: 1.0

  head_3:
    name: "AntiConfusion_Group_3"
    classes: [1, 6, 7, 10, 16, 19, 24, 25, 27, 28, 29, 34, 38, 39, 42, 45, 46, 47, 50, 55, 61, 62, 65, 66, 70, 73, 76]
    nc: 27
    sample_count: 198876
    weight: 1.0
```

---

## 8. é æœŸæ•ˆæœ

### 8.1 å„ªå‹¢

1. **æ¸›å°‘é¡åˆ¥æ··æ·†**ï¼šæ‰€æœ‰é«˜æ··æ·†å°éƒ½åˆ†é–‹ï¼Œä¸å†åœ¨åŒä¸€ Head å…§ç«¶çˆ­
2. **æ¨£æœ¬æ•¸å¹³è¡¡**ï¼šHead 1/2/3 å¹¾ä¹å®Œå…¨å¹³è¡¡ï¼ˆ23.1%ï¼‰
3. **person å°ˆç²¾**ï¼šæœ€å¤§é¡åˆ¥ç¨ç«‹è™•ç†ï¼Œé¿å…å£“åˆ¶å…¶ä»–é¡åˆ¥

### 8.2 æ½›åœ¨é¢¨éšª

1. **Head 0 åªæœ‰ 1 é¡**ï¼šå¯èƒ½å°è‡´è©² Head éåº¦æ“¬åˆ
2. **person èˆ‡å…¶ä»–é¡åˆ¥çš„äº’å‹•**ï¼šperson èˆ‡å…¶ä»–ç‰©ä»¶ï¼ˆå¦‚ backpack, umbrellaï¼‰çš„å…±ç¾é—œä¿‚å¯èƒ½ä¸Ÿå¤±

### 8.3 å»ºè­°å¯¦é©—

| å¯¦é©— | è¨­å®š | ç›®çš„ |
|------|------|------|
| **AntiConfusion v1** | å¦‚ä¸Š YAML | é©—è­‰åæ··æ·†æ•ˆæœ |
| **AntiConfusion v2** | person + å°‘é‡é…ä»¶ | æ¸¬è©¦ person åˆä½µæ•ˆæœ |

---

## 9. çµè«–

1. **åæ··æ·†æ˜¯ 1B4H çš„æ ¸å¿ƒå„ªå‹¢**ï¼šæŠŠå®¹æ˜“æ··æ·†çš„é¡åˆ¥åˆ†é–‹ï¼Œè®“å„ Head ç¨ç«‹åˆ¤æ–·
2. **æ¨£æœ¬æ•¸å¹³è¡¡æ¬¡é‡è¦**ï¼š1.32x çš„å·®è·å¯æ¥å—
3. **é¡åˆ¥æ•¸ä¸éœ€å¹³è¡¡**ï¼š1/26/26/27 çš„åˆ†ä½ˆæ²’å•é¡Œ
4. **person ç¨ç«‹è™•ç†**ï¼šå› ç‚ºä½” 30.5% æ¨£æœ¬ï¼Œç¨ç«‹ä¸€å€‹ Head æ˜¯åˆç†çš„

---

## 10. ä¸‹ä¸€æ­¥

1. å»ºç«‹ `data/coco_320_1b4h_anticonfusion.yaml`
2. åœ¨ vast.ai ä¸Šè¨“ç·´ 500 epochs
3. èˆ‡å…¶ä»–åˆ†é¡ç­–ç•¥æ¯”è¼ƒ mAP@0.5

---

*å ±å‘Šç”Ÿæˆæ™‚é–“: 2025-12-02*
*åŸºæ–¼ 1B1H 500ep è¨“ç·´çµæœåˆ†æ*
